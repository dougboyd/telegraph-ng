<h2 mat-dialog-title>Create Relationship</h2>
<div
  class="container"
  novalidate>
  <form
    [formGroup]="formGroup"
    (ngSubmit)="submitForm(formGroup.value)"
    class="form">
    <mat-dialog-content>
      <!-- Determine what type of object to use as the source of the relationship -->
      Relate a...
      <mat-button-toggle-group
        formControlName="sourceObject"
        appearance="legacy"
        aria-label="Font Style">
        <mat-button-toggle value="Person">Person</mat-button-toggle>
        <mat-button-toggle value="Opportunity">Opportunity</mat-button-toggle>
      </mat-button-toggle-group>

      <!-- Source Person -->
      @if(sourceObject == "Person") {
      <mat-form-field class="form-element">
        <mat-label>Person</mat-label>
        <!-- (selectionChange)="filterDataVisualisation()" -->
        <mat-select formControlName="sourcePerson">
          @for (person of personsForSelect$ | async; track person) {
          <mat-option [value]="person.name">{{ person.name }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      } @if(sourceObject == "Opportunity") {
      <!-- Opportunity -->
      <mat-form-field class="form-element">
        <mat-label>Opportunity</mat-label>
        <mat-select formControlName="sourceOpportunity">
          @for (opportunity of opportunitiesForSelect$ | async; track
          opportunity) {
          <mat-option [value]="opportunity.name">{{
            opportunity.name
          }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      }

      <!-- Relationship Type -->
      @if(sourceOpportunity || sourcePerson) {
      <mat-form-field class="form-element">
        <mat-label>Type of Relationship</mat-label>
        <!-- (selectionChange)="filterDataVisualisation()" -->
        <mat-select formControlName="relationshipType">
          @for (relationshipType of relationshipTypeForSelect$ | async; track
          relationshipType) {
          <mat-option [value]="relationshipType">{{
            modifyRelationshipType(relationshipType.label!)
          }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      }

      <!--Individual attributes for each relationship type -->
      <!-- Final Signoff -->
      @if(relationshipType.finalSignoff == 'BOOLEAN'){
      <mat-checkbox
        class="example-margin"
        formControlName="finalSignoff">
        Final Signoff Authority?
      </mat-checkbox>
      }
      <!-- Controls Funding -->
      @if(relationshipType.controlsFunding == 'BOOLEAN'){
      <mat-checkbox
        class="example-margin"
        formControlName="controlsFunding">
        Controls Funding?
      </mat-checkbox>
      }
      <!-- Relationship Warmth -->
      @if(relationshipType.relationshipWarmth){
      <mat-form-field class="form-element">
        <label>Relationship Warmth (-10 to 10) </label>
        <input
          matInput
          type="number"
          formControlName="relationshipWarmth" />
      </mat-form-field>
      }
      <!-- Influence Factor -->
      @if(relationshipType.influenceFactor){
      <mat-form-field class="form-element">
        <label>Influence Factor (-10 to 10)</label>
        <input
          matInput
          type="number"
          formControlName="influenceFactor" />
      </mat-form-field>
      }

      <!-- Determine what type of object to use as the target of the relationship -->
      @if(relationshipType.label){ ...to a
      <mat-button-toggle-group
        name="targetObject"
        formControlName="targetObject"
        aria-label="Font Style">
        <mat-button-toggle value="Person">Person</mat-button-toggle>
        <mat-button-toggle value="Opportunity">Opportunity</mat-button-toggle>
      </mat-button-toggle-group>
      }

      <!-- target Person -->
      @if(targetObject == "Person") {
      <mat-form-field class="form-element">
        <mat-label>Person</mat-label>
        <!-- (selectionChange)="filterDataVisualisation()" -->
        <mat-select formControlName="targetPerson">
          @for (person of personsForSelect$ | async; track person) {
          <mat-option [value]="person.name">{{ person.name }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      } @if(targetObject == "Opportunity") {
      <!-- Opportunity -->
      <mat-form-field class="form-element">
        <mat-label>Opportunity</mat-label>
        <mat-select formControlName="targetOpportunity">
          @for (opportunity of opportunitiesForSelect$ | async; track
          opportunity) {
          <mat-option [value]="opportunity.name">{{
            opportunity.name
          }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      }
    </mat-dialog-content>
    <mat-dialog-actions>
      <div class="form-element">
        <button
          mat-raised-button
          color="primary"
          type="submit"
          class="button"
          [disabled]="!formGroup.valid">
          Submit Form
        </button>
      </div>
    </mat-dialog-actions>
  </form>
</div>
